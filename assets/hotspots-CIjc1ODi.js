const e={addMode:!1,data:[],onUpdate:null,init:(t,s,o)=>{e.data=t||[],e.onUpdate=o,e.addMode=!1;const n=document.getElementById("hotspot-image");let r=s;r.startsWith("http")||(r=r.startsWith("img/")?r:`img/${r}`),n.onerror=null,n.src=r,n.onerror=function(){this.onerror=null,this.style.display="none";const i=document.getElementById("hotspot-editor");if(!i.querySelector(".error-msg")){const l=document.createElement("div");l.className="error-msg absolute inset-0 flex items-center justify-center bg-gray-100 text-gray-500 text-center p-4",l.innerHTML=`<div><div class="text-4xl mb-2">ğŸ–¼ï¸</div><div>Resim bulunamadÄ±:<br><code class="text-xs">${r}</code></div></div>`,i.appendChild(l)}},n.onload=function(){this.style.display="block";const i=document.getElementById("hotspot-editor").querySelector(".error-msg");i&&i.remove()},e.renderMarkers(),e.renderList();const d=document.getElementById("btn-hotspot-mode");d&&(d.textContent="ğŸ¯ Nokta Ekle Modu",d.classList.add("bg-orange-600"),d.classList.remove("bg-green-600"));const a=document.getElementById("hotspot-click-layer");a&&(a.style.cursor="default")},toggleMode:()=>{e.addMode=!e.addMode;const t=document.getElementById("btn-hotspot-mode"),s=document.getElementById("hotspot-click-layer");e.addMode?(t.textContent="âœ‹ Ä°ptal (Ekleme Modu AÃ§Ä±k)",t.classList.remove("bg-orange-600"),t.classList.add("bg-green-600"),s.style.cursor="crosshair"):(t.textContent="ğŸ¯ Nokta Ekle Modu",t.classList.remove("bg-green-600"),t.classList.add("bg-orange-600"),s.style.cursor="default")},handleClick:t=>{if(!e.addMode)return;document.getElementById("hotspot-editor");const o=document.getElementById("hotspot-image").getBoundingClientRect(),n=t.clientX-o.left,r=t.clientY-o.top,d=Math.round(n/o.width*100),a=Math.round(r/o.height*100);if(d<0||d>100||a<0||a>100)return;const i=prompt("Bu noktanÄ±n adÄ± ne olsun? (Ã¶rn: USB Port)");if(!i)return;const l=prompt("AÃ§Ä±klama girin (Ã¶rn: Bilgisayara baÄŸlanmak iÃ§in kullanÄ±lÄ±r)")||"",c={name:i,desc:l,x:d,y:a,r:15};e.data.push(c),e.sync(),e.renderMarkers(),e.renderList(),e.toggleMode()},renderMarkers:()=>{const t=document.getElementById("hotspot-markers");t.innerHTML="",e.data.forEach((s,o)=>{const n=document.createElement("div");n.className="absolute w-6 h-6 bg-orange-500 border-2 border-white rounded-full shadow-lg flex items-center justify-center text-xs text-white font-bold",n.style.left=`calc(${s.x}% - 12px)`,n.style.top=`calc(${s.y}% - 12px)`,n.style.pointerEvents="auto",n.style.cursor="pointer",n.textContent=o+1,n.title=s.name,n.onclick=()=>e.select(o),t.appendChild(n)})},renderList:()=>{const t=document.getElementById("hotspot-list");if(e.data.length===0){t.innerHTML='<div class="text-center text-gray-400 text-sm py-4">HenÃ¼z nokta eklenmedi. "Nokta Ekle Modu"nu aÃ§Ä±p resme tÄ±klayÄ±n.</div>';return}t.innerHTML=e.data.map((s,o)=>`
            <div class="flex items-center justify-between bg-white p-2 rounded border text-sm">
                <div class="flex items-center gap-2">
                    <span class="w-6 h-6 bg-orange-500 text-white rounded-full flex items-center justify-center text-xs font-bold">${o+1}</span>
                    <div>
                        <div class="font-bold text-gray-700">${s.name}</div>
                        <div class="text-xs text-gray-400">${s.desc||"AÃ§Ä±klama yok"}</div>
                    </div>
                </div>
                <div class="flex gap-1">
                    <button type="button" onclick="HotspotEditor.edit(${o})" class="text-blue-500 hover:text-blue-700 p-1">âœï¸</button>
                    <button type="button" onclick="HotspotEditor.delete(${o})" class="text-red-500 hover:text-red-700 p-1">ğŸ—‘ï¸</button>
                </div>
            </div>
        `).join("")},select:t=>{document.querySelectorAll("#hotspot-markers > div").forEach((o,n)=>{n===t?o.classList.add("ring-2","ring-yellow-400"):o.classList.remove("ring-2","ring-yellow-400")})},edit:t=>{const s=e.data[t],o=prompt("Yeni isim:",s.name);if(o===null)return;const n=prompt("Yeni aÃ§Ä±klama:",s.desc);n!==null&&(s.name=o,s.desc=n,e.sync(),e.renderMarkers(),e.renderList())},delete:t=>{confirm(`"${e.data[t].name}" noktasÄ±nÄ± silmek istediÄŸinize emin misiniz?`)&&(e.data.splice(t,1),e.sync(),e.renderMarkers(),e.renderList())},clearAll:()=>{e.data.length!==0&&confirm("TÃ¼m etkileÅŸim noktalarÄ±nÄ± silmek istediÄŸinize emin misiniz?")&&(e.data=[],e.sync(),e.renderMarkers(),e.renderList())},sync:()=>{e.onUpdate&&e.onUpdate(e.data)}};window.HotspotEditor=e;
