/* Main CSS Entry Point */

/* Tailwind v4 Setup */
@import 'tailwindcss';

@theme {
    /* Brand Colors */
    --color-primary-50: #f0fdfa;
    --color-primary-100: #ccfbf1;
    --color-primary-200: #99f6e4;
    --color-primary-300: #5eead4;
    --color-primary-400: #2dd4bf;
    --color-primary-500: #00979c;
    --color-primary-600: #0d9488;
    --color-primary-700: #0f766e;
    --color-primary-800: #115e59;
    --color-primary-900: #134e4a;
    --color-primary-950: #042f2e;

    /* Theme Semantic Aliases */
    --color-theme: var(--color-primary-500);
    --color-theme-light: var(--color-primary-50);

    /* Spacing (Tailwind v4 already has a great default spacing scale, 
     but we'll define our specific aliases if needed) */
    --spacing-px: 1px;

    /* Typography */
    --font-sans: 'Nunito', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;

    /* Shadows */
    --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);
    --shadow-card-hover: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    --shadow-primary: 0 4px 14px 0 rgba(0, 151, 156, 0.3);

    /* Radius */
    --radius-xl: 0.75rem;
    --radius-2xl: 1rem;

    /* Letter Spacing */
    --tracking-tighter: -0.02em;
    --tracking-tightest: -0.05em;
}

/* Explicit Sources for Tailwind Scanning */
@source "../auth.html";
@source "../index.html";
@source "../profile.html";
@source "../teacher.html";
@source "../admin.html";
@source "../student-dashboard.html";
@source "../src/**/*.js";
@source "../modules/**/*.js";
@source "../views/**/*.js";
@source "../data/**/*.js";

/* Custom CSS Layers */
@layer base {
    /* Global body - Deep navy background by default */
    body {
        @apply font-sans transition-colors duration-300;
        background-color: var(--lab-bg-dark, #0f172a);
        color: var(--text-secondary, #cbd5e1);
    }

    /* Dark mode is now default - this ensures consistency */
    body,
    body.dark-mode,
    html.dark body,
    html.dark-mode body {
        background-color: var(--lab-bg-dark, #0f172a);
        color: var(--text-secondary, #cbd5e1);
    }

    /* Light mode override (only if explicitly set) */
    html.light body,
    html[data-theme='light'] body {
        @apply bg-gray-50 text-gray-900;
    }

    /* Consistent heading typography across all pages */
    h1 {
        font-size: var(--heading-h1, clamp(2rem, 5vw, 3rem));
        @apply font-extrabold tracking-tight leading-tight text-white;
    }

    h2 {
        font-size: var(--heading-h2, clamp(1.5rem, 4vw, 2.25rem));
        @apply font-bold tracking-tight leading-tight text-white;
    }

    h3 {
        font-size: var(--heading-h3, clamp(1.25rem, 3vw, 1.5rem));
        @apply font-semibold text-white;
    }

    h4 {
        font-size: var(--heading-h4, clamp(1rem, 2.5vw, 1.25rem));
        @apply font-semibold text-white;
    }
}

@layer components {
    /* ============================================
     COURSE CARDS - Premium Glassmorphism & Hover Effects
     ============================================ */
    .course-card {
        @apply relative overflow-hidden transition-all duration-300 border border-black/10 rounded-2xl bg-white;
        transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    /* Dark mode glassmorphism - Balanced for content visibility */
    .dark .course-card,
    .dark-mode .course-card,
    html.dark .course-card {
        background: rgba(30, 41, 59, 0.7);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.15);
    }

    .course-card::before {
        content: '';
        @apply absolute inset-0 opacity-0 transition-opacity duration-300 pointer-events-none z-0;
        background: linear-gradient(135deg, transparent 0%, rgba(0, 212, 255, 0.05) 100%);
    }

    .course-card:hover {
        @apply -translate-y-2 scale-105;
        filter: brightness(1.1);
        box-shadow:
            0 0 35px rgba(0, 151, 156, 0.3),
            0 20px 50px -10px rgba(0, 0, 0, 0.4);
        border-color: rgba(0, 212, 255, 0.5);
    }

    .course-card:hover::before {
        @apply opacity-100;
    }

    /* Shimmer Effect on Hover */
    .course-card::after {
        content: '';
        @apply absolute -inset-[50%] w-[200%] h-[200%] transition-transform duration-700 pointer-events-none z-10;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15), transparent);
        transform: rotate(45deg) translateX(-100%);
    }

    .course-card:hover::after {
        transform: rotate(45deg) translateX(100%);
    }

    /* Hotspots */
    .hotspot {
        @apply absolute w-6 h-6 bg-theme/80 border-2 border-white rounded-full cursor-pointer z-20 shadow-md flex items-center justify-center text-white font-bold text-sm transition-all duration-300;
    }

    .hotspot:hover {
        @apply scale-150 bg-orange-500;
    }

    /* Skeleton Loading */
    .skeleton {
        @apply bg-slate-200 bg-[length:200%_100%] rounded-lg;
        background-image: linear-gradient(90deg, #e5e7eb 25%, #f3f4f6 50%, #e5e7eb 75%);
        animation: skeleton-shimmer 1.5s infinite ease-in-out;
    }

    body.dark-mode .skeleton,
    html.dark .skeleton,
    html.dark-mode .skeleton {
        background-image: linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%);
    }

    @keyframes skeleton-shimmer {
        0% {
            background-position: 200% 0;
        }

        100% {
            background-position: -200% 0;
        }
    }

    /* ============================================
     LAYOUT TRANSITIONS & OVERLAYS
     ============================================ */

    /* Header Base State - Glassmorphism */
    #main-header {
        @apply transition-transform duration-300 ease-in-out;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        will-change: transform;
        transition-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .dark #main-header,
    .dark-mode #main-header,
    html.dark #main-header {
        background: rgba(15, 23, 42, 0.9);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    #main-header.nav-hidden {
        @apply -translate-y-full pointer-events-none;
    }

    #main-header.header-scrolled {
        @apply shadow-lg;
    }

    /* Bottom Nav */
    #mobile-bottom-nav {
        @apply transition-transform duration-300 ease-in-out border-t border-black/5 bg-white/95 backdrop-blur-md;
        will-change: transform;
        transition-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    #mobile-bottom-nav.nav-hidden {
        @apply translate-y-full pointer-events-none;
    }

    /* Sidebar */
    #lesson-sidebar {
        @apply -translate-x-full transition-transform duration-300 ease-in-out z-[60];
    }

    #lesson-sidebar.open {
        @apply translate-x-0;
    }

    .sidebar-overlay {
        @apply fixed inset-0 bg-black/50 opacity-0 pointer-events-none transition-opacity duration-300 z-[55];
    }

    .sidebar-overlay.open {
        @apply opacity-100 pointer-events-auto;
    }

    .active-lesson {
        @apply bg-theme-light text-theme border-r-4 border-theme;
    }

    /* Sidebar dark mode glassmorphism */
    #lesson-sidebar {
        background: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-right: 1px solid rgba(255, 255, 255, 0.1);
    }

    #sidebar-content {
        @apply py-2;
    }

    /* ============================================
       BRANDING & TYPOGRAPHY
       ============================================ */
    .brand-logo {
        @apply font-bold leading-none tracking-tighter;
    }

    .brand-logo .brand-lab {
        @apply font-black tracking-tightest text-[1.1em];
    }

    .brand-slogan {
        @apply font-semibold opacity-85 text-[0.8rem] tracking-tight;
    }

    .text-display {
        @apply font-extrabold tracking-tightest leading-[1.05];
    }

    .card-title {
        @apply font-bold tracking-tight;
    }

    /* ============================================
       PANEL SPECIFIC COMPONENTS
       ============================================ */

    /* Panel Backgrounds */
    .teacher-bg,
    .admin-bg {
        @apply min-h-screen transition-colors duration-500;
        background: linear-gradient(135deg, #f0fdfa 0%, #ecfdf5 50%, #f0f9ff 100%);
    }

    body.dark-mode .teacher-bg,
    body.dark-mode .admin-bg,
    html.dark .teacher-bg,
    html.dark .admin-bg,
    html.dark-mode .teacher-bg,
    html.dark-mode .admin-bg {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    }

    /* Glass Cards */
    .glass-card {
        @apply bg-white/90 backdrop-blur-xl border border-white/80 shadow-lg transition-all duration-300 rounded-2xl p-6;
    }

    .glass-card:hover {
        @apply -translate-y-0.5 shadow-xl;
    }

    body.dark-mode .glass-card,
    html.dark .glass-card,
    html.dark-mode .glass-card {
        @apply bg-slate-900/90 border-slate-700/50;
    }

    /* Stat Badges */
    .stat-badge {
        @apply text-sm leading-tight transition-all duration-200 rounded-xl p-4 shadow-sm hover:-translate-y-0.5 hover:shadow-md;
    }

    /* Classroom Code Box */
    .code-box-display {
        @apply font-mono text-2xl font-bold tracking-widest bg-emerald-50 border-2 border-dashed border-emerald-500 p-3 rounded-xl text-center text-emerald-600 cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:bg-emerald-100;
        user-select: all;
    }

    body.dark-mode .code-box-display,
    html.dark .code-box-display,
    html.dark-mode .code-box-display {
        @apply bg-emerald-950/40 border-emerald-400 text-emerald-300 hover:bg-emerald-900/60;
    }

    /* ============================================
       DASHBOARD LESSON CARDS - Glassmorphism
       ============================================ */
    .lesson-card {
        @apply relative overflow-hidden transition-all duration-300 rounded-xl cursor-pointer;
        background: rgba(30, 41, 59, 0.75);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.12);
        transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .lesson-card:hover {
        @apply -translate-y-1 scale-[1.03];
        background: rgba(30, 41, 59, 0.85);
        border-color: rgba(255, 140, 0, 0.4);
        box-shadow:
            0 8px 32px rgba(255, 140, 0, 0.15),
            0 0 0 1px rgba(255, 140, 0, 0.2);
    }

    .lesson-card .lesson-icon {
        @apply text-2xl mb-2 transition-transform duration-300;
    }

    .lesson-card:hover .lesson-icon {
        @apply scale-110;
    }

    .lesson-card .lesson-title {
        @apply font-bold text-white text-sm leading-tight transition-colors duration-300;
    }

    .lesson-card:hover .lesson-title {
        color: var(--cta-start, #ff8c00);
    }

    .lesson-card .lesson-meta {
        @apply text-xs text-slate-400;
    }

    /* Lesson card mini progress bar */
    .lesson-progress {
        @apply absolute bottom-0 left-0 right-0 h-1 overflow-hidden;
        background: rgba(0, 0, 0, 0.3);
    }

    .lesson-progress-fill {
        @apply h-full transition-all duration-500;
        background: linear-gradient(90deg, var(--cta-start, #ff8c00), var(--cta-end, #ff4500));
    }

    /* Completed lesson checkmark */
    .lesson-complete-badge {
        @apply absolute -top-1 -right-1 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold z-10;
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);
    }

    /* Locked lesson overlay */
    .lesson-locked {
        @apply relative;
    }

    .lesson-locked::before {
        content: '';
        @apply absolute inset-0 z-20 rounded-xl;
        background: rgba(15, 23, 42, 0.7);
        backdrop-filter: blur(3px);
    }

    .lesson-lock-icon {
        @apply absolute inset-0 z-30 flex items-center justify-center text-2xl opacity-80;
    }

    .lesson-locked .lesson-title,
    .lesson-locked .lesson-meta {
        @apply opacity-40;
    }

    /* ============================================
       DASHBOARD SECTION HEADERS - Glow Effect
       ============================================ */
    .phase-header {
        @apply flex items-center gap-3 mt-8 mb-4 pb-3 relative;
    }

    .phase-header::after {
        content: '';
        @apply absolute bottom-0 left-0 h-0.5;
        width: 60%;
        background: linear-gradient(90deg, var(--cta-start, #ff8c00), transparent);
        opacity: 0.6;
    }

    .phase-header-icon {
        @apply text-2xl relative;
        filter: drop-shadow(0 0 8px rgba(255, 140, 0, 0.5));
        animation: icon-glow 2s ease-in-out infinite alternate;
    }

    @keyframes icon-glow {
        0% {
            filter: drop-shadow(0 0 5px rgba(255, 140, 0, 0.3));
        }
        100% {
            filter: drop-shadow(0 0 12px rgba(255, 140, 0, 0.7));
        }
    }

    .phase-header-title {
        @apply text-lg font-bold text-white tracking-tight;
    }

    .phase-header-desc {
        @apply text-sm text-slate-400;
    }

    /* Dashboard container dark mode */
    .dashboard-content {
        @apply p-4;
    }

    /* ============================================
       LESSON PAGE - Research Lab Theme
       ============================================ */

    /* Dark Glassmorphic Content Panel */
    .lesson-content-panel {
        background: rgba(15, 23, 42, 0.85);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .lesson-content-panel h2,
    .lesson-content-panel h3,
    .lesson-content-panel h4,
    .lesson-content-panel p,
    .lesson-content-panel span,
    .lesson-content-panel li,
    .lesson-content-panel label {
        @apply text-white;
    }

    .lesson-content-panel .text-gray-600,
    .lesson-content-panel .text-gray-700,
    .lesson-content-panel .text-gray-800 {
        @apply text-slate-300;
    }

    .lesson-content-panel .text-gray-400,
    .lesson-content-panel .text-gray-500 {
        @apply text-slate-400;
    }

    /* Header section in lesson panel */
    .lesson-header {
        background: rgba(15, 23, 42, 0.6);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Tab Buttons - Glowing Orange Active State */
    .lesson-tab {
        @apply relative px-5 py-3.5 text-sm font-semibold transition-all duration-300;
        color: rgba(255, 255, 255, 0.6);
        background: transparent;
        border-bottom: 2px solid transparent;
    }

    .lesson-tab:hover {
        color: rgba(255, 255, 255, 0.9);
        background: rgba(255, 140, 0, 0.1);
    }

    .lesson-tab.active {
        color: #fff;
        background: rgba(255, 140, 0, 0.15);
        border-bottom-color: transparent;
    }

    .lesson-tab.active::after {
        content: '';
        @apply absolute bottom-0 left-2 right-2 h-0.5;
        background: linear-gradient(90deg, var(--cta-start, #ff8c00), var(--cta-end, #ff4500));
        box-shadow:
            0 0 12px rgba(255, 140, 0, 0.6),
            0 0 24px rgba(255, 140, 0, 0.3);
        border-radius: 2px;
    }

    .lesson-tab-icon {
        @apply mr-2 text-base;
    }

    /* Tab container */
    .lesson-tabs-container {
        background: rgba(15, 23, 42, 0.7);
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }

    /* Content Area - Dark Theme */
    .lesson-content-area {
        @apply p-6;
        background: rgba(15, 23, 42, 0.5);
    }

    .lesson-content-area .bg-gray-50,
    .lesson-content-area .bg-gray-100 {
        background: rgba(30, 41, 59, 0.8) !important;
        @apply border border-slate-600/50 text-white;
    }

    .lesson-content-area .bg-white {
        background: rgba(30, 41, 59, 0.9) !important;
        @apply border border-slate-600/30 text-white;
    }

    .lesson-content-area .bg-yellow-50 {
        background: rgba(234, 179, 8, 0.15) !important;
        @apply border-l-4 border-yellow-500;
    }

    .lesson-content-area .bg-blue-50 {
        background: rgba(59, 130, 246, 0.15) !important;
    }

    /* Code Blocks - Dark Inset Background */
    .lesson-content-area pre,
    .lesson-content-area code {
        @apply bg-slate-900 text-green-400 border border-slate-700;
    }

    .lesson-content-area .code-scroll {
        background: #0d1117 !important;
        @apply border border-slate-700 rounded-lg;
    }

    /* Quiz Styling */
    .lesson-content-area .quiz-question {
        background: rgba(30, 41, 59, 0.8) !important;
        @apply border border-slate-600/50;
    }

    .lesson-content-area .quiz-question p {
        @apply text-white;
    }

    .lesson-content-area .quiz-question button {
        background: rgba(51, 65, 85, 0.8) !important;
        @apply text-white border-slate-600 hover:bg-slate-600;
    }

    /* Materials Cards */
    .lesson-content-area .flex.items-start.bg-white,
    .lesson-content-area .flex.items-center.bg-gray-50 {
        background: rgba(30, 41, 59, 0.8) !important;
        @apply border border-slate-600/50 rounded-lg;
    }

    .lesson-content-area .flex.items-start.bg-white h4,
    .lesson-content-area .flex.items-start.bg-white p {
        @apply text-white;
    }

    /* Navigation Buttons - Brand Gradient */
    .lesson-nav-btn {
        @apply relative px-5 py-2.5 rounded-xl font-bold text-sm transition-all duration-300 transform;
        background: rgba(30, 41, 59, 0.9);
        border: 1px solid rgba(255, 140, 0, 0.3);
        color: #fff;
    }

    .lesson-nav-btn:hover {
        @apply scale-105;
        border-color: rgba(255, 140, 0, 0.6);
        box-shadow:
            0 0 20px rgba(255, 140, 0, 0.25),
            inset 0 0 20px rgba(255, 140, 0, 0.05);
    }

    .lesson-nav-btn:active {
        @apply scale-95;
    }

    .lesson-nav-btn.primary {
        background: linear-gradient(135deg, var(--cta-start, #ff8c00), var(--cta-end, #ff4500));
        border: none;
        box-shadow: 0 4px 15px rgba(255, 140, 0, 0.3);
    }

    .lesson-nav-btn.primary:hover {
        box-shadow: 0 6px 25px rgba(255, 140, 0, 0.5);
    }

    /* ============================================
       VIRTUAL LAB - Research Lab Frame
       ============================================ */
    .virtual-lab-container {
        background: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        @apply rounded-xl overflow-hidden;
    }

    .virtual-lab-header {
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        @apply px-4 py-3 flex justify-between items-center;
    }

    .virtual-lab-title {
        @apply font-bold text-white tracking-wide flex items-center gap-2;
    }

    /* Live Badge with Pulse Animation */
    .live-badge {
        @apply relative px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider;
        background: linear-gradient(135deg, #dc2626, #b91c1c);
        color: white;
        box-shadow: 0 0 15px rgba(220, 38, 38, 0.5);
    }

    .live-badge::before {
        content: '';
        @apply absolute -left-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full;
        background: #fff;
        animation: live-pulse 1.5s ease-in-out infinite;
    }

    @keyframes live-pulse {
        0%,
        100% {
            opacity: 1;
            transform: translateY(-50%) scale(1);
        }
        50% {
            opacity: 0.5;
            transform: translateY(-50%) scale(1.3);
        }
    }

    /* Fullscreen Toggle Button */
    .fullscreen-btn {
        @apply p-2 rounded-lg transition-all duration-300;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
    }

    .fullscreen-btn:hover {
        background: rgba(255, 140, 0, 0.2);
        border-color: rgba(255, 140, 0, 0.5);
        box-shadow: 0 0 15px rgba(255, 140, 0, 0.3);
    }

    .virtual-lab-content {
        @apply relative flex-grow flex flex-col justify-center items-center;
        background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%);
    }

    .virtual-lab-controls {
        background: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(8px);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        @apply p-3;
    }

    /* Info Box - Dark Theme */
    .virtual-lab-info {
        background: rgba(30, 58, 138, 0.3);
        border-top: 1px solid rgba(59, 130, 246, 0.3);
        @apply p-4 text-sm;
    }

    .virtual-lab-info,
    .virtual-lab-info span,
    .virtual-lab-info p {
        @apply text-blue-100;
    }

    .virtual-lab-info #info-title {
        @apply text-white font-bold text-lg;
    }

    /* Chart Card - Dark Theme */
    .chart-card {
        background: rgba(15, 23, 42, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.1);
        @apply rounded-xl p-4;
    }

    .chart-card h4 {
        @apply text-slate-400;
    }
}
