<!doctype html>
<html lang="tr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Y√∂netim Paneli | Yeti LAB</title>
        <link href="styles/output.css" rel="stylesheet" />
        <!-- Supabase SDK -->
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="modules/supabaseClient.js"></script>
        <script src="data/base.js"></script>
        <!-- Course data is now loaded dynamically via CourseLoader -->
        <script src="modules/courseLoader.js"></script>
        <script src="data/quiz.js"></script>
        <script src="modules/themes.js"></script>
        <script src="config/tabs.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
        <link
            href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800;900&display=swap"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="styles/admin.css" />
    </head>

    <body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">
        <!-- LOGIN SCREEN -->
        <div
            id="login-screen"
            class="fixed inset-0 z-[200] flex items-center justify-center bg-gradient-to-br from-blue-600 to-purple-700"
        >
            <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4">
                <div class="text-center mb-8">
                    <span class="text-5xl">üèîÔ∏è</span>
                    <h1 class="text-2xl font-bold text-gray-800 mt-4">Yeti LAB</h1>
                    <p class="text-gray-500">Y√∂netim Paneli</p>
                </div>

                <form id="login-form" onsubmit="handleLogin(event)" class="space-y-4">
                    <div>
                        <label class="block text-sm font-bold text-gray-600 mb-1">Email</label>
                        <input
                            type="email"
                            id="login-email"
                            required
                            class="w-full border-2 border-gray-200 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none transition"
                            placeholder="admin@example.com"
                        />
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-600 mb-1">≈ûifre</label>
                        <input
                            type="password"
                            id="login-password"
                            required
                            class="w-full border-2 border-gray-200 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none transition"
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                        />
                    </div>
                    <div id="login-error" class="hidden bg-red-100 text-red-700 px-4 py-2 rounded-lg text-sm"></div>
                    <button
                        type="submit"
                        id="login-btn"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition shadow-lg"
                    >
                        üîê Giri≈ü Yap
                    </button>
                </form>

                <p class="text-center text-gray-400 text-xs mt-6">Sadece yetkili kullanƒ±cƒ±lar giri≈ü yapabilir.</p>
            </div>
        </div>

        <!-- MAIN ADMIN PANEL (hidden until logged in) -->
        <div id="admin-panel" class="hidden">
            <!-- √úst Bar -->
            <nav class="bg-theme text-white shadow-md sticky top-0 z-50 transition-colors duration-500">
                <!-- Row 1: Logo, Autosave Status (daha g√∂r√ºn√ºr) -->
                <div class="max-w-7xl mx-auto px-4 py-2 flex justify-between items-center border-b border-white/10">
                    <div class="flex items-center gap-4">
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">üèîÔ∏è</span>
                            <h1 class="text-xl font-bold" style="letter-spacing: -0.03em">
                                Yeti <span style="font-weight: 900">LAB</span>
                            </h1>
                        </div>
                        <span class="text-gray-300">|</span>
                        <span class="font-medium">Y√∂netim Paneli</span>
                    </div>

                    <!-- Kayƒ±t Durumu (DAHA G√ñR√úN√úR) & Kullanƒ±cƒ± -->
                    <div class="flex items-center gap-4">
                        <div
                            id="autosave-status"
                            class="flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/20 font-bold text-sm"
                        >
                            <span class="inline-block w-2 h-2 rounded-full bg-green-400 animate-pulse"></span>
                            <span>Hazƒ±r</span>
                        </div>
                        <span id="user-email" class="text-gray-300 text-sm hidden"></span>
                        <a href="index.html" class="text-gray-300 hover:text-white transition text-sm">‚Üê Siteye D√∂n</a>
                    </div>
                </div>

                <!-- Row 2: Tabs & Actions -->
                <div class="max-w-7xl mx-auto px-4 py-2 flex justify-between items-center">
                    <!-- Sekmeler -->
                    <div class="flex bg-white/10 rounded-lg p-1 gap-1">
                        <button
                            onclick="admin.showTab('projects')"
                            id="tab-projects"
                            class="tab-btn px-4 py-1.5 rounded-md text-sm font-bold transition active"
                        >
                            üìö Dersler
                        </button>
                        <button
                            onclick="admin.showTab('phases')"
                            id="tab-phases"
                            class="tab-btn px-4 py-1.5 rounded-md text-sm font-bold transition text-gray-300 hover:text-white"
                        >
                            üìÅ Fazlar
                        </button>
                        <button
                            onclick="admin.showTab('components')"
                            id="tab-components"
                            class="tab-btn px-4 py-1.5 rounded-md text-sm font-bold transition text-gray-300 hover:text-white"
                        >
                            üîß Devre Elemanlarƒ±
                        </button>
                    </div>

                    <!-- Aksiyonlar -->
                    <div class="flex items-center gap-2">
                        <button
                            onclick="admin.undo()"
                            id="btn-undo"
                            class="hidden bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded font-bold transition text-sm"
                            title="Son silinen √∂ƒüeyi geri al"
                        >
                            ‚Ü©Ô∏è Geri Al
                        </button>
                        <button
                            onclick="admin.downloadBackup()"
                            class="bg-blue-500 hover:bg-blue-600 px-4 py-1.5 rounded font-bold transition text-sm"
                            title="T√ºm verileri JSON olarak indir"
                        >
                            üì• Yedekle
                        </button>
                        <button
                            onclick="admin.saveData()"
                            class="bg-green-500 hover:bg-green-600 px-4 py-1.5 rounded font-bold transition text-sm"
                        >
                            üíæ Kaydet
                        </button>
                        <button
                            onclick="handleLogout()"
                            class="bg-red-500 hover:bg-red-600 px-4 py-1.5 rounded font-bold transition text-sm"
                            title="√áƒ±kƒ±≈ü Yap"
                        >
                            üö™
                        </button>
                    </div>
                </div>
            </nav>

            <div class="max-w-7xl mx-auto w-full px-4 py-8 flex-grow">
                <!-- KURS Y√ñNETƒ∞M PANELƒ∞ (Birle≈üik) -->
                <div class="bg-gradient-to-r from-theme/10 to-transparent border border-theme/20 rounded-lg mb-6">
                    <button
                        type="button"
                        onclick="admin.toggleCourseSettings()"
                        class="w-full flex items-center justify-between p-4 text-left hover:bg-white/30 transition"
                    >
                        <div class="flex items-center gap-3">
                            <span class="text-2xl" id="course-icon-preview">üîß</span>
                            <div>
                                <h3 class="font-bold text-gray-700" id="course-title-preview">Kurs Ba≈ülƒ±ƒüƒ±</h3>
                                <p class="text-sm text-gray-500" id="course-desc-preview">Kurs a√ßƒ±klamasƒ±</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-xs text-gray-400">Ayarlarƒ± d√ºzenlemek i√ßin tƒ±klayƒ±n</span>
                            <span id="course-settings-toggle" class="text-gray-400 text-xl transition-transform"
                                >‚ñº</span
                            >
                        </div>
                    </button>

                    <div id="course-settings-form" class="hidden border-t border-theme/20 bg-white/50">
                        <!-- B√∂l√ºm 1: Kurs Se√ßimi ve Y√∂netimi -->
                        <div class="p-4 border-b border-gray-200">
                            <div class="flex items-center justify-between mb-3">
                                <label class="text-xs font-bold text-gray-500 uppercase">üìö Kurs Se√ß veya Y√∂net</label>
                                <button
                                    type="button"
                                    onclick="CourseManager.showInlineAddForm()"
                                    class="text-xs bg-theme text-white px-3 py-1 rounded hover:bg-theme-dark transition"
                                >
                                    + Yeni Kurs Ekle
                                </button>
                            </div>

                            <!-- Kurs Se√ßim Kartlarƒ± -->
                            <div
                                id="course-selector-grid"
                                class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2 mb-3"
                            >
                                <!-- JS tarafƒ±ndan doldurulacak -->
                            </div>

                            <!-- Inline Yeni Kurs Formu (gizli) -->
                            <div id="inline-add-course-form" class="hidden mt-3 p-3 bg-gray-50 rounded-lg border">
                                <div class="grid grid-cols-12 gap-2">
                                    <input
                                        type="text"
                                        id="inline-course-icon"
                                        placeholder="üìö"
                                        class="col-span-1 border rounded p-2 text-center text-xl"
                                        maxlength="2"
                                    />
                                    <input
                                        type="text"
                                        id="inline-course-title"
                                        placeholder="Kurs Ba≈ülƒ±ƒüƒ±"
                                        class="col-span-4 border rounded p-2 font-bold"
                                    />
                                    <input
                                        type="text"
                                        id="inline-course-key"
                                        placeholder="kurs-anahtari"
                                        class="col-span-3 border rounded p-2 text-sm font-mono"
                                    />
                                    <input
                                        type="text"
                                        id="inline-course-desc"
                                        placeholder="A√ßƒ±klama"
                                        class="col-span-4 border rounded p-2 text-sm"
                                    />
                                </div>
                                <div class="flex justify-end gap-2 mt-2">
                                    <button
                                        type="button"
                                        onclick="CourseManager.hideInlineAddForm()"
                                        class="text-xs text-gray-500 px-3 py-1 hover:bg-gray-200 rounded"
                                    >
                                        ƒ∞ptal
                                    </button>
                                    <button
                                        type="button"
                                        onclick="CourseManager.createFromInline()"
                                        class="text-xs bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600"
                                    >
                                        Olu≈ütur
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- B√∂l√ºm 2: Se√ßili Kursun Ayarlarƒ± -->
                        <div class="p-4 border-b border-gray-200">
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-3"
                                >‚öôÔ∏è Se√ßili Kurs Ayarlarƒ±</label
                            >
                            <div class="grid grid-cols-12 gap-4">
                                <div class="col-span-2">
                                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Simge</label>
                                    <input
                                        type="text"
                                        id="course-icon"
                                        class="w-full border rounded p-2 text-center text-2xl"
                                        placeholder="üéì"
                                        onchange="admin.updateCourseSettings()"
                                    />
                                </div>
                                <div class="col-span-4">
                                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1"
                                        >Kurs Ba≈ülƒ±ƒüƒ±</label
                                    >
                                    <input
                                        type="text"
                                        id="course-title"
                                        class="w-full border rounded p-2 font-bold"
                                        placeholder="Arduino ile Robotik"
                                        oninput="admin.updateCourseSettings()"
                                    />
                                </div>
                                <div class="col-span-6">
                                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">A√ßƒ±klama</label>
                                    <input
                                        type="text"
                                        id="course-description"
                                        class="w-full border rounded p-2"
                                        placeholder="20 Haftalƒ±k Kapsamlƒ± Eƒüitim Seti"
                                        oninput="admin.updateCourseSettings()"
                                    />
                                </div>
                            </div>
                        </div>

                        <!-- B√∂l√ºm 3: Sekme ƒ∞sim Edit√∂r√º -->
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <label class="text-xs font-bold text-gray-500 uppercase">üè∑Ô∏è Ders Sekme ƒ∞simleri</label>
                                <button
                                    type="button"
                                    onclick="admin.resetTabNames()"
                                    class="text-xs text-gray-400 hover:text-gray-600"
                                >
                                    ‚Ü∫ Varsayƒ±lana D√∂n
                                </button>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2" id="tab-names-editor">
                                <!-- Dinamik olarak doldurulacak -->
                            </div>
                            <p class="text-xs text-gray-400 mt-3">
                                üí° Bu sekme isimleri derslerde g√∂r√ºn√ºr (Ama√ß, Donanƒ±m, Devre, Kod vb.)
                            </p>
                        </div>
                    </div>
                </div>

                <!-- PROJELER SEKMESƒ∞ -->
                <div id="view-projects" class="flex items-start gap-6 h-full">
                    <!-- Sol Men√º -->
                    <div
                        class="w-1/3 bg-white rounded-lg shadow overflow-hidden sticky top-24 max-h-[80vh] flex flex-col"
                    >
                        <div class="p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center">
                            <h2 class="font-bold text-lg text-gray-700">Ders Listesi</h2>
                            <button
                                onclick="admin.addNewProject()"
                                class="text-xs bg-gray-100 text-theme hover:bg-gray-200 px-2 py-1 rounded font-bold"
                            >
                                + Yeni Ekle
                            </button>
                        </div>
                        <div id="project-list" class="overflow-y-auto p-2 space-y-1 flex-grow"></div>
                    </div>

                    <!-- Saƒü Form -->
                    <div class="w-2/3 bg-white rounded-lg shadow p-6">
                        <div id="project-welcome" class="text-center py-16 text-gray-500">
                            <div class="text-6xl mb-4">üìö</div>
                            <h2 class="text-xl font-bold text-gray-600 mb-2">Ders Se√ßin veya Olu≈üturun</h2>
                            <p class="text-gray-400 mb-6 max-w-md mx-auto">
                                Soldan bir ders se√ßin veya yeni bir ders olu≈üturarak ba≈ülayƒ±n.
                            </p>
                            <button
                                onclick="admin.addNewProject()"
                                class="inline-flex items-center gap-2 bg-theme hover:bg-theme-dark text-white px-6 py-3 rounded-lg font-bold transition shadow-lg"
                            >
                                <span class="text-xl">‚ú®</span>
                                Yeni Ders Olu≈ütur
                            </button>
                        </div>
                        <form id="project-form" class="hidden h-full flex flex-col">
                            <div class="flex justify-between items-center border-b pb-4 mb-4">
                                <div class="flex items-center gap-4">
                                    <h3 class="text-xl font-bold text-theme">Ders D√ºzenle</h3>
                                    <!-- Language Switcher -->
                                    <div class="flex bg-gray-100 rounded-lg p-1" id="lang-switcher">
                                        <button
                                            type="button"
                                            onclick="admin.switchLang('tr')"
                                            id="lang-btn-tr"
                                            class="lang-btn px-3 py-1 rounded text-sm font-bold bg-theme text-white"
                                        >
                                            üáπüá∑ TR
                                        </button>
                                        <button
                                            type="button"
                                            onclick="admin.switchLang('en')"
                                            id="lang-btn-en"
                                            class="lang-btn px-3 py-1 rounded text-sm font-bold text-gray-500 hover:text-gray-700"
                                        >
                                            üá¨üáß EN
                                        </button>
                                    </div>
                                </div>
                                <div class="space-x-2">
                                    <button
                                        type="button"
                                        onclick="admin.duplicateProject()"
                                        class="text-blue-500 hover:text-blue-700 text-sm font-bold"
                                    >
                                        üìã Kopyala
                                    </button>
                                    <button
                                        type="button"
                                        onclick="admin.deleteProject()"
                                        class="text-red-500 hover:text-red-700 text-sm font-bold"
                                    >
                                        üóëÔ∏è Sil
                                    </button>
                                </div>
                            </div>

                            <!-- Tek Sayfa Form Yapƒ±sƒ± (Sekmesiz) -->
                            <div class="overflow-y-auto flex-grow pr-2 space-y-8">
                                <!-- B√ñL√úM: GENEL -->
                                <div id="pcontent-genel" class="space-y-4">
                                    <h3 class="text-lg font-bold text-gray-700 border-b pb-2 flex items-center gap-2">
                                        ‚öôÔ∏è Genel Bilgiler
                                    </h3>
                                    <div class="grid grid-cols-12 gap-4">
                                        <div class="col-span-2">
                                            <label class="block text-xs font-bold text-gray-500 uppercase">ID</label>
                                            <input
                                                type="text"
                                                id="p-id"
                                                class="w-full border rounded p-2 bg-gray-100 font-mono text-center font-bold"
                                                readonly
                                                disabled
                                            />
                                        </div>
                                        <div class="col-span-2">
                                            <label class="block text-xs font-bold text-gray-500 uppercase">ƒ∞kon</label>
                                            <input
                                                type="text"
                                                id="p-icon"
                                                class="w-full border rounded p-2 text-center"
                                            />
                                        </div>
                                        <div class="col-span-8">
                                            <label class="block text-xs font-bold text-gray-500 uppercase"
                                                >Ders Ba≈ülƒ±ƒüƒ±</label
                                            >
                                            <div class="lang-field lang-tr">
                                                <input
                                                    type="text"
                                                    id="p-title-tr"
                                                    class="w-full border rounded p-2"
                                                    placeholder="T√ºrk√ße ba≈ülƒ±k..."
                                                />
                                            </div>
                                            <div class="lang-field lang-en hidden">
                                                <input
                                                    type="text"
                                                    id="p-title-en"
                                                    class="w-full border rounded p-2"
                                                    placeholder="English title..."
                                                />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-xs font-bold text-gray-500 uppercase"
                                                >Faz (Phase)</label
                                            >
                                            <select id="p-phase" class="w-full border rounded p-2 bg-white">
                                                <option value="0">Faz se√ßin...</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-bold text-gray-500 uppercase"
                                                >Hafta (Opsiyonel)</label
                                            >
                                            <input
                                                type="number"
                                                id="p-week"
                                                class="w-full border rounded p-2"
                                                placeholder="1"
                                            />
                                        </div>
                                    </div>

                                    <!-- NEW: Metadata Fields -->
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-xs font-bold text-gray-500 uppercase"
                                                >Zorluk Seviyesi</label
                                            >
                                            <select id="p-difficulty" class="w-full border rounded p-2">
                                                <option value="beginner">üü¢ Ba≈ülangƒ±√ß</option>
                                                <option value="intermediate">üü° Orta</option>
                                                <option value="advanced">üî¥ ƒ∞leri</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-bold text-gray-500 uppercase"
                                                >Tahmini S√ºre</label
                                            >
                                            <input
                                                type="text"
                                                id="p-duration"
                                                class="w-full border rounded p-2"
                                                placeholder="30 dakika"
                                            />
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-bold text-gray-500 uppercase"
                                            >Etiketler (virg√ºlle ayƒ±rƒ±n)</label
                                        >
                                        <input
                                            type="text"
                                            id="p-tags"
                                            class="w-full border rounded p-2"
                                            placeholder="led, temel, dijital"
                                        />
                                    </div>
                                    <div>
                                        <label class="block text-xs font-bold text-gray-500 uppercase"
                                            >√ñn Gereksinimler (Ders ID'leri, virg√ºlle)</label
                                        >
                                        <input
                                            type="text"
                                            id="p-prerequisites"
                                            class="w-full border rounded p-2"
                                            placeholder="1, 2, 3"
                                        />
                                    </div>
                                    <!-- END: Metadata Fields -->

                                    <div>
                                        <label class="block text-xs font-bold text-gray-500 uppercase"
                                            >Kƒ±sa A√ßƒ±klama (Listede g√∂r√ºn√ºr)</label
                                        >
                                        <div class="lang-field lang-tr">
                                            <input
                                                type="text"
                                                id="p-desc-tr"
                                                class="w-full border rounded p-2"
                                                placeholder="T√ºrk√ße a√ßƒ±klama..."
                                            />
                                        </div>
                                        <div class="lang-field lang-en hidden">
                                            <input
                                                type="text"
                                                id="p-desc-en"
                                                class="w-full border rounded p-2"
                                                placeholder="English description..."
                                            />
                                        </div>
                                    </div>

                                    <!-- Tab Visibility Toggles -->
                                    <div class="bg-gray-50 p-3 rounded border border-gray-200">
                                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2"
                                            >Sekme G√∂r√ºn√ºrl√ºk Ayarlarƒ±</label
                                        >
                                        <div class="flex flex-wrap gap-4">
                                            <label class="flex items-center space-x-2 cursor-pointer text-sm">
                                                <input
                                                    type="checkbox"
                                                    id="p-show-mission"
                                                    class="rounded text-green-600"
                                                    onchange="ProjectManager.toggleSection('mission')"
                                                    checked
                                                />
                                                <span id="lbl-chk-mission">üéØ Ama√ß</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer text-sm">
                                                <input
                                                    type="checkbox"
                                                    id="p-show-materials"
                                                    class="rounded text-green-600"
                                                    onchange="ProjectManager.toggleSection('materials')"
                                                    checked
                                                />
                                                <span id="lbl-chk-materials">üß© Donanƒ±m</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer text-sm">
                                                <input
                                                    type="checkbox"
                                                    id="p-show-circuit"
                                                    class="rounded text-green-600"
                                                    onchange="ProjectManager.toggleSection('circuit')"
                                                    checked
                                                />
                                                <span id="lbl-chk-circuit">‚ö° Devre</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer text-sm">
                                                <input
                                                    type="checkbox"
                                                    id="p-show-code"
                                                    class="rounded text-green-600"
                                                    onchange="ProjectManager.toggleSection('code')"
                                                    checked
                                                />
                                                <span id="lbl-chk-code">üíª Kod</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer text-sm">
                                                <input
                                                    type="checkbox"
                                                    id="p-show-challenge"
                                                    class="rounded text-green-600"
                                                    onchange="ProjectManager.toggleSection('challenge')"
                                                    checked
                                                />
                                                <span id="lbl-chk-challenge">üèÜ G√∂rev</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer text-sm">
                                                <input
                                                    type="checkbox"
                                                    id="p-show-quiz"
                                                    class="rounded text-green-600"
                                                    onchange="ProjectManager.toggleSection('quiz')"
                                                    checked
                                                />
                                                <span id="lbl-chk-quiz">üìù Test</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- B√ñL√úM: ƒ∞√áERƒ∞K -->
                                <div id="pcontent-icerik" class="space-y-4">
                                    <h3 class="text-lg font-bold text-theme border-b pb-2 flex items-center gap-2">
                                        üìñ ƒ∞√ßerik Detaylarƒ±
                                    </h3>
                                    <div>
                                        <label id="lbl-mission" class="block text-xs font-bold text-gray-500 uppercase"
                                            >üéØ Ama√ß</label
                                        >
                                        <div class="lang-field lang-tr">
                                            <textarea
                                                id="p-mission-tr"
                                                rows="4"
                                                class="w-full border rounded p-2 text-sm"
                                                placeholder="T√ºrk√ße ama√ß a√ßƒ±klamasƒ±..."
                                            ></textarea>
                                        </div>
                                        <div class="lang-field lang-en hidden">
                                            <textarea
                                                id="p-mission-en"
                                                rows="4"
                                                class="w-full border rounded p-2 text-sm"
                                                placeholder="English mission description..."
                                            ></textarea>
                                        </div>
                                    </div>

                                    <div>
                                        <label class="block text-xs font-bold text-gray-500 uppercase"
                                            >üìö Teorik Bilgi</label
                                        >
                                        <div class="lang-field lang-tr">
                                            <textarea
                                                id="p-theory-tr"
                                                rows="5"
                                                class="w-full border rounded p-2 text-sm"
                                                placeholder="T√ºrk√ße teori..."
                                            ></textarea>
                                        </div>
                                        <div class="lang-field lang-en hidden">
                                            <textarea
                                                id="p-theory-en"
                                                rows="5"
                                                class="w-full border rounded p-2 text-sm"
                                                placeholder="English theory..."
                                            ></textarea>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-bold text-gray-500 uppercase"
                                            >üèÜ Meydan Okuma Bilgi</label
                                        >
                                        <div class="lang-field lang-tr">
                                            <textarea
                                                id="p-challenge-tr"
                                                rows="3"
                                                class="w-full border rounded p-2 text-sm"
                                                placeholder="T√ºrk√ße meydan okuma a√ßƒ±klamasƒ±..."
                                            ></textarea>
                                        </div>
                                        <div class="lang-field lang-en hidden">
                                            <textarea
                                                id="p-challenge-en"
                                                rows="3"
                                                class="w-full border rounded p-2 text-sm"
                                                placeholder="English challenge description..."
                                            ></textarea>
                                        </div>
                                    </div>
                                </div>

                                <!-- B√ñL√úM: DONANIM -->
                                <div id="pcontent-donanim" class="space-y-4">
                                    <h3 class="text-lg font-bold text-gray-700 border-b pb-2 flex items-center gap-2">
                                        üß© Donanƒ±m Bilgileri
                                    </h3>
                                    <label
                                        id="lbl-materials"
                                        class="block text-xs font-bold text-gray-500 uppercase mb-1"
                                        >Devre Elemanlarƒ±</label
                                    >
                                    <div class="bg-gray-50 border rounded p-2">
                                        <div
                                            id="p-materials-list"
                                            class="grid grid-cols-2 md:grid-cols-3 gap-2 mb-2 max-h-60 overflow-y-auto"
                                        ></div>
                                        <input
                                            type="text"
                                            id="p-materials-custom"
                                            placeholder="Diƒüer malzemeler (virg√ºl ile ayƒ±rƒ±n...)"
                                            class="w-full border-t pt-2 mt-2 bg-transparent text-sm"
                                        />
                                    </div>
                                </div>

                                <!-- B√ñL√úM: DEVRE & Sƒ∞M√úLASYON -->
                                <div id="pcontent-devre" class="space-y-4">
                                    <h3 class="text-lg font-bold text-blue-600 border-b pb-2 flex items-center gap-2">
                                        ‚ö° Devre ≈ûemasƒ± ve Sim√ºlasyon
                                    </h3>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label
                                                id="lbl-circuit"
                                                class="block text-xs font-bold text-gray-500 uppercase mb-1"
                                                >Sim√ºlasyon Tipi</label
                                            >
                                            <div class="flex gap-2">
                                                <select
                                                    id="p-simType"
                                                    class="flex-1 border p-2 rounded text-sm bg-gray-50 focus:bg-white transition"
                                                    onchange="admin.toggleCustomSimType()"
                                                >
                                                    <option value="led">LED Yakma</option>
                                                    <option value="button">Buton Kullanƒ±mƒ±</option>
                                                    <option value="pot">Potansiyometre</option>
                                                    <option value="streetLight">Sokak Lambasƒ±</option>
                                                    <option value="traffic">Trafik Lambasƒ±</option>
                                                    <option value="rgb">RGB Led</option>
                                                    <option value="dht">Sƒ±caklƒ±k Sens√∂r√º</option>
                                                    <option value="ultrasonic">Mesafe Sens√∂r√º</option>
                                                    <option value="servo">Servo Motor</option>
                                                    <option value="countdown">Geri Sayƒ±m</option>
                                                    <option value="melody">Melodi √áal</option>
                                                    <option value="radar">Radar Ekranƒ±</option>
                                                    <option value="clap">Alkƒ±≈ü Sens√∂r√º</option>
                                                    <option value="fire">Ate≈ü Sens√∂r√º</option>
                                                    <option value="moisture">Toprak Nem</option>
                                                    <option value="flood">Su Seviyesi</option>
                                                    <option value="theremin">Theremin</option>
                                                    <option value="hourglass">Kum Saati</option>
                                                    <option value="knight_rider">Kara ≈ûim≈üek</option>
                                                    <option value="explorer_board">Kart Ke≈üfi</option>
                                                    <option value="custom">-- √ñzel Gir --</option>
                                                </select>
                                                <input
                                                    type="text"
                                                    id="p-simType-custom"
                                                    class="flex-1 border p-2 rounded text-sm bg-white hidden"
                                                    placeholder="Sim√ºlasyon Kodu..."
                                                />
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-bold text-gray-500 uppercase"
                                                >Devre/Blok Resmi</label
                                            >
                                            <p class="text-xs text-gray-400 mb-1">
                                                Dosya adƒ± (led.jpg) veya tam URL (https://...)
                                            </p>
                                            <div class="flex gap-1">
                                                <input
                                                    type="text"
                                                    id="p-circuitImage"
                                                    class="flex-1 border rounded p-2 text-sm"
                                                    placeholder="devre1.jpg veya https://example.com/img.png"
                                                    onchange="admin.previewCircuitImage()"
                                                />
                                                <button
                                                    type="button"
                                                    class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-1 px-2 rounded text-xs whitespace-nowrap"
                                                    onclick="admin.openImageSelector('p-circuitImage')"
                                                >
                                                    üñºÔ∏è Se√ß
                                                </button>
                                                <label
                                                    class="bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-2 rounded text-xs cursor-pointer whitespace-nowrap"
                                                >
                                                    ‚¨ÜÔ∏è Y√ºkle
                                                    <input
                                                        type="file"
                                                        accept="image/*"
                                                        class="hidden"
                                                        onchange="admin.uploadCircuitImage(this)"
                                                    />
                                                </label>
                                            </div>
                                            <div id="circuit-image-preview" class="mt-2 hidden">
                                                <img
                                                    id="circuit-preview-img"
                                                    src=""
                                                    class="max-h-32 rounded border shadow-sm"
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Hotspots - Always Visible -->
                                    <div
                                        id="container-hotspots"
                                        class="transition-all duration-300 bg-orange-50 p-4 rounded border border-orange-200 mt-4"
                                    >
                                        <!-- Enable Checkboxes -->
                                        <div
                                            class="flex items-center justify-between mb-3 border-b border-orange-200 pb-3"
                                        >
                                            <div class="flex items-center gap-4">
                                                <label class="flex items-center gap-2 cursor-pointer">
                                                    <input
                                                        type="checkbox"
                                                        id="p-enableHotspots"
                                                        class="rounded text-orange-600"
                                                        onchange="admin.toggleHotspotEnabled()"
                                                    />
                                                    <span class="text-sm font-bold text-orange-800"
                                                        >Etkile≈üim Noktasƒ± Ekle</span
                                                    >
                                                </label>
                                                <label class="flex items-center gap-2 cursor-pointer">
                                                    <input
                                                        type="checkbox"
                                                        id="p-showInLab"
                                                        class="rounded text-blue-600"
                                                    />
                                                    <span class="text-sm font-bold text-blue-700"
                                                        >üß™ Sanal Lab'da G√∂ster</span
                                                    >
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Editor Content (Hidden until enabled) -->
                                        <div id="hotspot-editor-content" class="hidden">
                                            <div class="flex justify-between items-center mb-2">
                                                <label class="block text-xs font-bold text-orange-800 uppercase"
                                                    >Etkile≈üim Noktalarƒ±</label
                                                >
                                                <div class="flex gap-2">
                                                    <button
                                                        type="button"
                                                        onclick="admin.toggleHotspotMode()"
                                                        id="btn-hotspot-mode"
                                                        class="text-xs bg-orange-600 text-white px-3 py-1 rounded hover:bg-orange-700"
                                                    >
                                                        üéØ Nokta Ekle Modu
                                                    </button>
                                                    <button
                                                        type="button"
                                                        onclick="admin.clearAllHotspots()"
                                                        class="text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600"
                                                    >
                                                        üóëÔ∏è T√ºm√ºn√º Sil
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- Visual Editor Canvas -->
                                            <div
                                                id="hotspot-editor"
                                                class="relative bg-gray-200 rounded overflow-hidden mb-3"
                                                style="height: 350px"
                                            >
                                                <img
                                                    id="hotspot-image"
                                                    src=""
                                                    alt="Devre Resmi"
                                                    class="max-w-full max-h-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"
                                                    style="cursor: crosshair"
                                                />
                                                <div
                                                    id="hotspot-markers"
                                                    class="absolute inset-0 pointer-events-none"
                                                ></div>
                                                <div
                                                    id="hotspot-click-layer"
                                                    class="absolute inset-0"
                                                    onclick="admin.handleEditorClick(event)"
                                                    style="cursor: crosshair"
                                                ></div>
                                            </div>

                                            <!-- Hotspot List -->
                                            <div id="hotspot-list" class="space-y-2 max-h-40 overflow-y-auto"></div>

                                            <!-- Hidden JSON field for data sync -->
                                            <input type="hidden" id="p-hotspots" />
                                        </div>
                                        <!-- /hotspot-editor-content -->
                                    </div>
                                </div>

                                <!-- B√ñL√úM: KOD -->
                                <div id="pcontent-kod" class="space-y-4">
                                    <h3 class="text-lg font-bold text-green-600 border-b pb-2 flex items-center gap-2">
                                        üíª Kodlama ve Bloklar
                                    </h3>
                                    <div class="flex justify-between items-center mb-1">
                                        <label id="lbl-code" class="block text-xs font-bold text-gray-500 uppercase"
                                            >Proje Kodu</label
                                        >
                                        <div class="flex items-center space-x-4">
                                            <div class="flex items-center space-x-2">
                                                <label class="text-xs font-bold">Grafik:</label>
                                                <select id="p-hasGraph" class="text-xs border rounded p-1">
                                                    <option value="false">Yok</option>
                                                    <option value="true">Var</option>
                                                </select>
                                            </div>
                                            <select
                                                id="p-code-mode"
                                                class="text-xs border rounded p-1"
                                                onchange="admin.toggleCodeMode()"
                                            >
                                                <option value="text">Metin Modu</option>
                                                <option value="image">Resim Modu (Blok)</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div id="code-text-area">
                                        <textarea
                                            id="p-code"
                                            rows="12"
                                            class="w-full border rounded p-2 font-mono text-xs bg-gray-900 text-green-400"
                                        ></textarea>
                                    </div>
                                    <div id="code-image-area" class="hidden">
                                        <label class="block text-xs text-gray-500 mb-1">Resim Dosya Adƒ±:</label>
                                        <div class="flex gap-1">
                                            <input
                                                type="text"
                                                id="p-code-image-input"
                                                class="w-full border rounded p-2"
                                                placeholder="ornek: blok_kodu.png"
                                                oninput="document.getElementById('p-code').value = this.value"
                                            />
                                            <button
                                                class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-1 px-3 rounded text-xs whitespace-nowrap"
                                                onclick="admin.openImageSelector('p-code-image-input', 'p-code')"
                                            >
                                                üñºÔ∏è Se√ß
                                            </button>
                                        </div>
                                        <p class="text-xs text-gray-400 mt-1">
                                            G√∂rselin 'img/' klas√∂r√ºnde olduƒüundan emin olun.
                                        </p>
                                    </div>
                                </div>

                                <!-- B√ñL√úM: TEST (QUIZ) -->
                                <div id="pcontent-test" class="space-y-4">
                                    <h3 class="text-lg font-bold text-purple-600 border-b pb-2 flex items-center gap-2">
                                        üìù Test Sorularƒ± (Quiz)
                                    </h3>
                                    <div class="flex justify-between items-center mb-4">
                                        <h4 id="lbl-quiz" class="font-bold text-gray-700">Soru Listesi</h4>
                                        <button
                                            type="button"
                                            onclick="admin.addQuestion()"
                                            class="bg-green-100 text-green-700 hover:bg-green-200 px-3 py-1 rounded text-sm font-bold"
                                        >
                                            + Soru Ekle
                                        </button>
                                    </div>
                                    <div id="quiz-editor-list" class="space-y-6"></div>
                                    <div id="quiz-empty-msg" class="text-center text-gray-400 py-8 hidden">
                                        Bu derste hen√ºz test sorusu yok.
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- MALZEMELER SEKMESƒ∞ -->
                <div id="view-components" class="hidden flex items-start gap-6 h-full">
                    <!-- Sol Men√º -->
                    <div
                        class="w-1/3 bg-white rounded-lg shadow overflow-hidden sticky top-24 max-h-[80vh] flex flex-col"
                    >
                        <div class="p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center">
                            <h2 id="lbl-components" class="font-bold text-lg text-gray-700">Devre Elemanlarƒ±</h2>
                            <button
                                onclick="admin.addNewComponent()"
                                class="text-xs bg-purple-100 text-purple-800 hover:bg-purple-200 px-2 py-1 rounded font-bold"
                            >
                                + Yeni Ekle
                            </button>
                        </div>
                        <div id="component-list" class="overflow-y-auto p-2 space-y-1 flex-grow"></div>
                    </div>

                    <!-- Saƒü Form -->
                    <div class="w-2/3 bg-white rounded-lg shadow p-6">
                        <div id="component-welcome" class="text-center py-20 text-gray-500">
                            <h2 class="text-2xl font-bold text-gray-400">D√ºzenlemek i√ßin bir malzeme se√ßin</h2>
                        </div>
                        <form id="component-form" class="hidden space-y-4">
                            <div class="flex justify-between items-center border-b pb-4 mb-4">
                                <h3 class="text-xl font-bold text-purple-600">Eleman D√ºzenle</h3>
                                <button
                                    type="button"
                                    onclick="admin.deleteComponent()"
                                    class="text-red-500 hover:text-red-700 text-sm"
                                >
                                    üóëÔ∏è Sil
                                </button>
                            </div>

                            <div>
                                <label class="block text-xs font-bold text-gray-500 uppercase">ID (Anahtar ƒ∞sim)</label>
                                <input type="text" id="c-key" class="w-full border rounded p-2 bg-gray-100" readonly />
                                <p class="text-xs text-gray-400 mt-1">Bu isim kod i√ßinde kullanƒ±lƒ±r, deƒüi≈ütirilemez.</p>
                            </div>

                            <div class="grid grid-cols-4 gap-4">
                                <div class="col-span-3">
                                    <label class="block text-xs font-bold text-gray-500 uppercase">G√∂r√ºnen ƒ∞sim</label>
                                    <input type="text" id="c-name" class="w-full border rounded p-2" />
                                </div>
                                <div class="col-span-1">
                                    <label class="block text-xs font-bold text-gray-500 uppercase">ƒ∞kon</label>
                                    <input type="text" id="c-icon" class="w-full border rounded p-2 text-center" />
                                </div>
                            </div>

                            <div>
                                <label class="block text-xs font-bold text-gray-500 uppercase"
                                    >Resim Dosyasƒ± (√∂rn: sensor_ldr.jpg)</label
                                >
                                <div class="flex gap-1">
                                    <input type="text" id="c-imgFileName" class="w-full border rounded p-2" />
                                    <button
                                        type="button"
                                        class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-1 px-3 rounded text-xs whitespace-nowrap"
                                        onclick="admin.openImageSelector('c-imgFileName')"
                                    >
                                        üñºÔ∏è Se√ß
                                    </button>
                                </div>
                            </div>

                            <div>
                                <label class="block text-xs font-bold text-gray-500 uppercase">A√ßƒ±klama</label>
                                <textarea id="c-desc" rows="3" class="w-full border rounded p-2"></textarea>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- FAZLAR SEKMESƒ∞ -->
                <div id="view-phases" class="hidden flex items-start gap-6 h-full">
                    <!-- Sol Men√º -->
                    <div
                        class="w-1/3 bg-white rounded-lg shadow overflow-hidden sticky top-24 max-h-[80vh] flex flex-col"
                    >
                        <div class="p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center">
                            <h2 class="font-bold text-lg text-gray-700">Faz Listesi</h2>
                            <button
                                onclick="admin.addNewPhase()"
                                class="text-xs bg-amber-100 text-amber-800 hover:bg-amber-200 px-2 py-1 rounded font-bold"
                            >
                                + Yeni Ekle
                            </button>
                        </div>
                        <div id="phase-list" class="overflow-y-auto p-2 space-y-1 flex-grow"></div>
                    </div>

                    <!-- Saƒü Form -->
                    <div class="w-2/3 bg-white rounded-lg shadow p-6">
                        <div id="phase-welcome" class="text-center py-20 text-gray-500">
                            <h2 class="text-2xl font-bold text-gray-400">D√ºzenlemek i√ßin bir faz se√ßin</h2>
                        </div>
                        <form id="phase-form" class="hidden space-y-4">
                            <div class="flex justify-between items-center border-b pb-4 mb-4">
                                <h3 class="text-xl font-bold text-amber-600">Faz D√ºzenle</h3>
                                <button
                                    type="button"
                                    onclick="admin.deletePhase()"
                                    class="text-red-500 hover:text-red-700 text-sm"
                                >
                                    üóëÔ∏è Sil
                                </button>
                            </div>

                            <div class="grid grid-cols-12 gap-4">
                                <div class="col-span-12 md:col-span-4">
                                    <label class="block text-xs font-bold text-gray-500 uppercase">B√∂l√ºm Adƒ±</label>
                                    <input
                                        type="text"
                                        id="ph-title"
                                        class="w-full border rounded p-2 font-bold"
                                        placeholder="Ba≈ülangƒ±√ß veya B√∂l√ºm 1..."
                                    />
                                </div>
                                <div class="col-span-12 md:col-span-2">
                                    <label class="block text-xs font-bold text-gray-500 uppercase">ƒ∞kon</label>
                                    <input
                                        type="text"
                                        id="ph-icon"
                                        class="w-full border rounded p-2 text-center text-xl"
                                        placeholder="üöÄ"
                                    />
                                </div>
                                <div class="col-span-12 md:col-span-4">
                                    <label class="block text-xs font-bold text-gray-500 uppercase">A√ßƒ±klama</label>
                                    <input
                                        type="text"
                                        id="ph-desc"
                                        class="w-full border rounded p-2"
                                        placeholder="Giri≈ü Seviyesi"
                                    />
                                </div>
                                <div class="col-span-4">
                                    <label class="block text-xs font-bold text-gray-500 uppercase"
                                        >Renk (Tailwind)</label
                                    >
                                    <select id="ph-color" class="w-full border rounded p-2">
                                        <option value="blue">Mavi</option>
                                        <option value="green">Ye≈üil</option>
                                        <option value="purple">Mor</option>
                                        <option value="orange">Turuncu</option>
                                        <option value="red">Kƒ±rmƒ±zƒ±</option>
                                        <option value="teal">Turkuaz</option>
                                        <option value="pink">Pembe</option>
                                        <option value="gray">Gri</option>
                                    </select>
                                </div>
                            </div>
                            <p class="text-xs text-gray-400">
                                Bu faza ait dersler, Ders d√ºzenleme ekranƒ±ndan "Phase" alanƒ± ile atanƒ±r.
                            </p>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Sticky Save Bar (Bottom) -->
            <div
                id="sticky-save-bar"
                class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-40 hidden"
            >
                <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <span id="sticky-save-status" class="text-sm text-gray-500">
                            <span class="inline-block w-2 h-2 rounded-full bg-green-500 mr-2"></span>
                            T√ºm deƒüi≈üiklikler kaydedildi
                        </span>
                    </div>
                    <div class="flex items-center gap-2">
                        <button
                            onclick="admin.downloadBackup()"
                            class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded font-bold text-sm transition"
                        >
                            üì• Yedekle
                        </button>
                        <button
                            onclick="admin.saveData()"
                            class="bg-theme hover:bg-theme-dark text-white px-6 py-2 rounded font-bold text-sm transition shadow"
                        >
                            üíæ Supabase'e Kaydet
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /admin-panel -->

        <!-- Image Selector Modal -->
        <div
            id="image-selector-modal"
            class="fixed inset-0 z-[100] hidden flex items-center justify-center bg-black/50 backdrop-blur-sm p-4"
        >
            <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col">
                <div class="p-4 border-b flex justify-between items-center bg-gray-50 rounded-t-lg">
                    <h3 class="font-bold text-lg text-gray-800">üñºÔ∏è Resim Se√ß</h3>
                    <button onclick="admin.closeImageSelector()" class="text-gray-500 hover:text-gray-700 text-2xl">
                        &times;
                    </button>
                </div>
                <div
                    class="p-4 overflow-y-auto grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4"
                    id="image-selector-grid"
                >
                    <!-- Images will be loaded here -->
                </div>
                <div class="p-4 border-t bg-gray-50 rounded-b-lg text-right">
                    <button
                        onclick="admin.closeImageSelector()"
                        class="px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded text-gray-800 font-bold text-sm"
                    >
                        ƒ∞ptal
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Module -->
        <!-- Core Modules -->
        <script src="constants/elements.js"></script>
        <script src="modules/admin/hotspots.js"></script>
        <script src="modules/admin/quizzes.js"></script>
        <script src="modules/admin/components.js"></script>
        <script src="modules/admin/projects.js"></script>
        <script src="modules/admin/phases.js"></script>
        <script src="modules/admin/settings.js"></script>
        <script src="modules/admin/storage.js"></script>
        <script src="modules/admin/images.js"></script>
        <script src="modules/admin/courses.js"></script>
        <script src="modules/admin/supabase-sync.js"></script>
        <script src="modules/admin.js"></script>
        <script>
            // ========================================
            // AUTH HANDLERS
            // ========================================

            async function handleLogin(event) {
                event.preventDefault();

                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                const errorDiv = document.getElementById('login-error');
                const loginBtn = document.getElementById('login-btn');

                errorDiv.classList.add('hidden');
                loginBtn.disabled = true;
                loginBtn.textContent = '‚è≥ Giri≈ü yapƒ±lƒ±yor...';

                try {
                    // Initialize Supabase if not already
                    if (!SupabaseClient.client) {
                        SupabaseClient.init();
                    }

                    await SupabaseClient.signIn(email, password);

                    if (!SupabaseClient.isAdmin) {
                        throw new Error('Bu hesap admin yetkisine sahip deƒüil.');
                    }

                    showAdminPanel();
                } catch (error) {
                    console.error('Login error:', error);
                    errorDiv.textContent = error.message || 'Giri≈ü ba≈üarƒ±sƒ±z. Email veya ≈üifre hatalƒ±.';
                    errorDiv.classList.remove('hidden');
                } finally {
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'üîê Giri≈ü Yap';
                }
            }

            async function handleLogout() {
                if (confirm('√áƒ±kƒ±≈ü yapmak istediƒüinize emin misiniz?')) {
                    try {
                        await SupabaseClient.signOut();
                        showLoginScreen();
                    } catch (error) {
                        console.error('Logout error:', error);
                    }
                }
            }

            function showLoginScreen() {
                document.getElementById('login-screen').classList.remove('hidden');
                document.getElementById('admin-panel').classList.add('hidden');
            }

            function showAdminPanel() {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('admin-panel').classList.remove('hidden');

                // Show user email
                const userEmail = document.getElementById('user-email');
                if (SupabaseClient.currentUser) {
                    userEmail.textContent = SupabaseClient.currentUser.email;
                    userEmail.classList.remove('hidden');
                }

                // Initialize admin if courses loaded
                initializeAdmin();
            }

            async function initializeAdmin() {
                // Initialize courseData container (for fallback compatibility)
                window.courseData = window.courseData || {};

                // Admin.init() now handles Supabase-First loading internally
                // CourseLoader is only used as fallback if Supabase is unavailable
                try {
                    await admin.init();
                } catch (err) {
                    console.error('Error initializing admin:', err);
                    alert('Y√ºkleme hatasƒ±. L√ºtfen sayfayƒ± yenileyin.');
                }
            }

            // ========================================
            // INITIALIZATION
            // ========================================

            window.onload = async () => {
                // Initialize Supabase
                SupabaseClient.init();

                // Check if already logged in
                const session = await SupabaseClient.getSession();

                if (session && SupabaseClient.isAdmin) {
                    showAdminPanel();
                } else {
                    showLoginScreen();
                }
            };
        </script>
    </body>
</html>
